(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{737:function(e,a,t){"use strict";t.r(a);var n=t(38),s=t(39),r=t(90),c=t(89),o=t(91),l=t(0),i=t.n(l),d=t(420),u=t(138),m=t(88),p=t(715),h=t(441),f=t(442),g=t(443),E=t(716),w=t(445),y=t(446),b=t(423),v=t(433),N=t(428),P=t(140),S=t(2),A=function(e,a){return function(t){t({type:S.a,payload:{authKey:btoa(e+":"+a)}}),t({type:S.b})}},C=function(e){return function(a){a({type:S.e,payload:{ipAddress:e}}),a({type:S.b})}},x=t(104),k=t(67);function I(e){var a=document.location.href,t=a.split("?");if(t.length>=2){for(var n=t.shift(),s=t.join("?"),r=encodeURIComponent(e)+"=",c=s.split(/[&;]/g),o=c.length;o-- >0;)-1!==c[o].lastIndexOf(r,0)&&c.splice(o,1);a=c.length>0?n+"?"+c.join("&"):n,window.history.pushState("",document.title,a)}return a}var O=function(e){function a(e){var t;Object(n.a)(this,a),(t=Object(r.a)(this,Object(c.a)(a).call(this,e))).changeUserName=function(e){t.setState({username:e.target.value,connectionSuccess:!1})},t.changePassword=function(e){t.setState({password:e.target.value,connectionSuccess:!1})},t.changeIPAddress=function(e){t.setState({ipAddress:e.target.value,connectionSuccess:!1})},t.redirectToDashboard=function(){t.props.history.push("/dashboard")},t.onSubmit=function(e){e&&e.preventDefault();var a=t.state,n=a.ipAddress,s=a.username,r=a.password;Promise.all([A(s,r),C(n)]).then(function(){t.redirectToDashboard()})},t.checkConnection=function(e){e.preventDefault();var a=t.state,n=a.ipAddress,s=a.username,r=a.password,c=t.props,o=c.changeUserNamePassword,l=c.changeIPAddress;Promise.all([o(s,r),l(n)]).then(function(){x.a.post(k.a.noopAuth).then(function(e){console.log("Connection successful."),t.setState({connectionSuccess:!0,error:""})},function(e){console.log(e),t.setState({connectionSuccess:!1,error:"Error connecting. Please check username password and verify if rclone is working at the specified IP."})})})};var s=window.location.href.split("#/")[0];return-1!==s.indexOf("?")&&(s=window.location.href.split("?")[0]),t.state={username:"",password:"",ipAddress:s,connectionSuccess:!1,error:""},t}return Object(o.a)(a,e),Object(s.a)(a,[{key:"componentDidMount",value:function(){localStorage.clear(),this.props.signOut();var e=window.location.href,a=new URL(e),t=a.searchParams.get("login_token"),n=this.state.ipAddress;a.searchParams.get("ip_address")&&(n=a.searchParams.get("ip_address")),t&&(Promise.all([this.props.changeAuthKey(t),this.props.changeIPAddress(n)]),I("login_token"),I("ip_address"),this.redirectToDashboard())}},{key:"render",value:function(){var e=this.state,a=e.username,t=e.password,n=e.ipAddress,s=e.connectionSuccess,r=e.error;return i.a.createElement("div",{className:"app flex-row align-items-center","data-test":"loginComponent"},i.a.createElement(d.a,null,i.a.createElement(u.a,{className:"justify-content-center"},i.a.createElement(m.a,{md:"8"},i.a.createElement(p.a,null,i.a.createElement(h.a,{className:"p-4"},i.a.createElement(f.a,null,i.a.createElement(g.a,{onSubmit:this.onSubmit},i.a.createElement("h1",null,"Login"),i.a.createElement("p",{className:"text-muted"},"Sign In to your account"),r&&i.a.createElement(E.a,{color:"danger",children:r}),s&&i.a.createElement(E.a,{color:"success",children:"Connection verified. You may now login."}),i.a.createElement(w.a,{className:"mb-3"},i.a.createElement(y.a,{addonType:"prepend"},i.a.createElement(b.a,null,i.a.createElement("i",{className:"icon-user"}))),i.a.createElement(v.a,{type:"text",placeholder:"IP Address / URL",autoComplete:"ipAddress",onChange:this.changeIPAddress,value:n})),i.a.createElement(w.a,{className:"mb-3"},i.a.createElement(y.a,{addonType:"prepend"},i.a.createElement(b.a,null,i.a.createElement("i",{className:"icon-user"}))),i.a.createElement(v.a,{type:"text",placeholder:"Username",autoComplete:"username",onChange:this.changeUserName,value:a})),i.a.createElement(w.a,{className:"mb-4"},i.a.createElement(y.a,{addonType:"prepend"},i.a.createElement(b.a,null,i.a.createElement("i",{className:"icon-lock"}))),i.a.createElement(v.a,{type:"password",placeholder:"Password",autoComplete:"current-password",onChange:this.changePassword,value:t})),i.a.createElement(u.a,null,i.a.createElement(m.a,{xs:"6"},i.a.createElement(N.a,{color:"primary",className:"px-4",disabled:!s},"Login")),i.a.createElement(m.a,{xs:"6",className:"text-right"},i.a.createElement(N.a,{onClick:this.checkConnection,color:"primary",className:"px-4"},"Verify")))))),i.a.createElement(h.a,{className:"text-white bg-primary py-5 d-md-down-none",style:{width:"44%"}},i.a.createElement(f.a,{className:"text-center"},i.a.createElement("div",null))))))))}}]),a}(l.Component);a.default=Object(P.b)(null,{signOut:function(){return function(e){e({type:S.E})}},changeUserNamePassword:A,changeIPAddress:C,changeAuthKey:function(e){return function(a){a({type:S.a,payload:{authKey:e}}),a({type:S.b})}}})(O)}}]);
//# sourceMappingURL=3.5e6515a1.chunk.js.map