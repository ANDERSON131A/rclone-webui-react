(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{382:function(e,t,n){"use strict";n.d(t,"c",function(){return c}),n.d(t,"b",function(){return l});var a=n(388),r=n.n(a),i=n(389),o=n(404),s=n.n(o).a.create({baseURL:localStorage.getItem("ipAddress"),headers:{"Content-Type":"application/json"},responseType:"json"});function c(e,t,n,a,r,i){return u(e,t,n,a,r,i,"move")}function l(e,t,n,a,r,i){return u(e,t,n,a,r,i,"copy")}function u(e,t,n,a,r,i,o){return d.apply(this,arguments)}function d(){return(d=Object(i.a)(r.a.mark(function e(t,n,a,i,o,c,l){var u,d,f,h;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u="",u="move"===l?c?"/sync/move":"/operations/movefile":c?"/sync/copy":"/operations/copyfile",!c){e.next=10;break}return d=n.split("/"),f={srcFs:t+n,dstFs:a+i+"/"+d[d.length-1]},e.next=7,s.post(u,f);case 7:return e.abrupt("return",e.sent);case 10:return""===i?i=o:i+="/"+o,h={srcFs:t,srcRemote:n,dstFs:a,dstRemote:i},e.next=14,s.post(u,h);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}},e)}))).apply(this,arguments)}s.interceptors.request.use(function(e){return e.headers.Authorization="Basic "+btoa(localStorage.getItem("username")+":"+localStorage.getItem("password")),e},function(e){return Promise.reject(e)}),t.a=s},383:function(e,t,n){"use strict";function a(e){return 0===e?0:e/1024/1024/1024}function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(e<1)return"0 B";var n=t<0?0:t,a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(n))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][a]}function i(e){function t(e){return e>1?"s":""}var n=Math.floor(e/31536e3);if(n)return n+" year"+t(n);var a=Math.floor((e%=31536e3)/86400);if(a)return a+" day"+t(a);var r=Math.floor((e%=86400)/3600);if(r)return r+" hour"+t(r);var i=Math.floor((e%=3600)/60);return i?i+" minute"+t(i):(e%=60)?e.toFixed(2)+" second"+t(e):"Just now"}function o(e,t){return e.test(t)}function s(e){return o(/^(off|(([0-9]+[.][0-9]+|[0-9]+)([KMGTP])))$/i,e)}function c(e){return o(/^([0-9]+)$/,e)}function l(e){return o(/^(\d+[h])?(\d+[m])?(\d+[s])?(\d+ms)??$/i,e)}function u(e,t){return e.find(function(e,n,a){return t===e.Prefix})}function d(e){return-1===e.indexOf(":")&&":"!==e[e.length-1]&&(e+=":"),e}n.d(t,"b",function(){return a}),n.d(t,"g",function(){return r}),n.d(t,"i",function(){return i}),n.d(t,"l",function(){return s}),n.d(t,"k",function(){return c}),n.d(t,"j",function(){return l}),n.d(t,"f",function(){return u}),n.d(t,"a",function(){return d}),n.d(t,"c",function(){return h}),n.d(t,"d",function(){return p}),n.d(t,"h",function(){return m}),t.e=function(e){if(Array.isArray(e))return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};var f={Images:"image/jpeg",Pdf:"application/pdf"};function h(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:f)[t];return n?e.filter(function(e){return e.IsDir||e.MimeType===n}):e}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(t=t.toLowerCase())?e.filter(function(e){return e.Name.toLowerCase().startsWith(t)}):e}function m(e){return e&&""!==e&&"/"===e[0]}},420:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var a=n(382),r=n(7),i=function(){return function(e){a.a.post("/config/providers").then(function(t){return e({type:r.l,payload:t.data.providers})})}},o=function(){return function(e){a.a.post("/config/dump").then(function(t){return e({type:r.i,status:r.s,payload:t.data})},function(t){return e({type:r.i,status:r.r,payload:t})})}}},629:function(e,t,n){"use strict";n.r(t);var a=n(385),r=n(388),i=n.n(r),o=n(389),s=n(8),c=n(25),l=n(42),u=n(43),d=n(128),f=n(127),h=n(132),p=n(129),m=n(0),v=n.n(m),g=n(621),b=n(622),E=n(397),y=n(402),O=n(3),j=n(17),S=n(1),k=n.n(S),x=n(63),C=n.n(x),N=n(380),V={children:k.a.node,tag:N.n,className:k.a.string,cssModule:k.a.object,valid:k.a.bool,tooltip:k.a.bool},w={tag:"div",valid:void 0},M=function(e){var t=e.className,n=e.cssModule,a=e.valid,r=e.tooltip,i=e.tag,o=Object(j.a)(e,["className","cssModule","valid","tooltip","tag"]),s=r?"tooltip":"feedback",c=Object(N.j)(C()(t,a?"valid-"+s:"invalid-"+s),n);return v.a.createElement(i,Object(O.a)({},o,{className:c}))};M.propTypes=V,M.defaultProps=w;var I,T=M,A=n(418),D=n(398),P=n(436),R=n(394),F=n(18),q=n(130),B=n(396),H=n(446),G=Object(B.a)({},H.Transition.propTypes,{isOpen:k.a.bool,children:k.a.oneOfType([k.a.arrayOf(k.a.node),k.a.node]),tag:N.n,className:k.a.node,navbar:k.a.bool,cssModule:k.a.object,innerRef:k.a.oneOfType([k.a.func,k.a.string,k.a.object])}),L=Object(B.a)({},H.Transition.defaultProps,{isOpen:!1,appear:!1,enter:!0,exit:!0,tag:"div",timeout:N.c.Collapse}),z=((I={})[N.b.ENTERING]="collapsing",I[N.b.ENTERED]="collapse show",I[N.b.EXITING]="collapsing",I[N.b.EXITED]="collapse",I);function J(e){return e.scrollHeight}var $=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={height:null},["onEntering","onEntered","onExit","onExiting","onExited"].forEach(function(e){n[e]=n[e].bind(Object(q.a)(Object(q.a)(n)))}),n}Object(F.a)(t,e);var n=t.prototype;return n.onEntering=function(e,t){this.setState({height:J(e)}),this.props.onEntering(e,t)},n.onEntered=function(e,t){this.setState({height:null}),this.props.onEntered(e,t)},n.onExit=function(e){this.setState({height:J(e)}),this.props.onExit(e)},n.onExiting=function(e){e.offsetHeight;this.setState({height:0}),this.props.onExiting(e)},n.onExited=function(e){this.setState({height:null}),this.props.onExited(e)},n.render=function(){var e=this,t=this.props,n=t.tag,a=t.isOpen,r=t.className,i=t.navbar,o=t.cssModule,s=t.children,c=(t.innerRef,Object(j.a)(t,["tag","isOpen","className","navbar","cssModule","children","innerRef"])),l=this.state.height,u=Object(N.l)(c,N.a),d=Object(N.k)(c,N.a);return v.a.createElement(H.Transition,Object(O.a)({},u,{in:a,onEntering:this.onEntering,onEntered:this.onEntered,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}),function(t){var a=function(e){return z[e]||"collapse"}(t),c=Object(N.j)(C()(r,a,i&&"navbar-collapse"),o),u=null===l?null:{height:l};return v.a.createElement(n,Object(O.a)({},d,{style:Object(B.a)({},d.style,u),className:c,ref:e.props.innerRef}),s)})},t}(m.Component);$.propTypes=G,$.defaultProps=L;var K=$,U=n(399),W=n(470),X=n(631),Y=n(618),Z=n(619),_=n(620),Q=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(f.a)(t).call(this,e))).toggle=n.toggle.bind(Object(h.a)(n)),n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"toggle",value:function(){this.props.closeModal()}},{key:"render",value:function(){var e=this.props.isVisible;return v.a.createElement("div",null,v.a.createElement(X.a,{isOpen:e,toggle:this.toggle},v.a.createElement(Y.a,{toggle:this.toggle,"data-test":"modalHeader"},"Configuring your drive."),v.a.createElement(Z.a,{"data-test":"modalBody"},"A page will open for you with the authentication for your drive. This modal will automatically dismiss upon successful creation"),v.a.createElement(_.a,{"data-test":"modalFooter"},v.a.createElement(R.a,{color:"primary",onClick:this.toggle},"Done")," ")))}}]),t}(v.a.Component);Q.defaultProps={isVisible:!0};var ee=Q,te=n(382),ne=n(383),ae=n(447),re=n.n(ae),ie=function(e,t){var n=t.trim().toLowerCase(),a=n.length;return 0===a?e:0===a?[]:e.filter(function(e){return e.Description.toLowerCase().slice(0,a)===n})},oe=function(e){return e.Prefix},se=function(e){return v.a.createElement("div",null,e.Description)},ce=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(f.a)(t).call(this,e))).onSuggestionsFetchRequested=function(e){var t=e.value;n.setState({suggestions:ie(n.props.suggestions,t)})},n.onSuggestionsClearRequested=function(){n.setState({suggestions:[]})},n.state={suggestions:[]},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.value,n=e.onChange,a=e.suggestions,r=Object(ne.f)(a,t),i={placeholder:"Type a provider type",value:void 0===r?t:r.Description,onChange:n};return v.a.createElement(re.a,{suggestions:this.state.suggestions,onSuggestionsFetchRequested:this.onSuggestionsFetchRequested,onSuggestionsClearRequested:this.onSuggestionsClearRequested,getSuggestionValue:oe,renderSuggestion:se,alwaysRenderSuggestions:!0,highlightFirstSuggestion:!0,inputProps:i})}}]),t}(v.a.Component),le=n(134),ue=n(420),de=n(131);function fe(e){var t=e.drivePrefix,n=e.loadAdvanced,a=e.changeHandler,r=e.currentValues,i=e.isValidMap,o=e.errorsMap,s=e.config;if(void 0!==t&&""!==t){var c=Object(ne.f)(s,t),l=[];if(void 0!==c)l=c.Options.map(function(e,t){if(0===e.Hide&&(n&&e.Advanced||!n&&!e.Advanced)){var s="".concat(e.Help),c=e.Required?v.a.createElement("i",{className:"text-red"},"*"):null,l=!Object(ne.e)(e.Examples),u=null,d="";return e.IsPassword?d="password":l?d="string":"bool"===e.Type?(d="select",u=[v.a.createElement("option",{key:1,value:!0},"Yes"),v.a.createElement("option",{key:2,value:!1},"No")]):d="int"===e.Type?"number":(e.Type,"text"),v.a.createElement(g.a,{key:t,row:!0},v.a.createElement(b.a,{for:e.Name,sm:5},s,c),v.a.createElement(E.a,{sm:7},v.a.createElement(y.a,{type:d,value:r[e.Name],name:e.Name,valid:i[e.Name],invalid:!i[e.Name],id:e.Name,onChange:a,required:e.Required},u),v.a.createElement(T,null,o[e.Name])))}return null});return l}return v.a.createElement("div",null,"Select a drive type to continue")}function he(e){var t=e.key,n=e.id,a=e.label,r=e.changeHandler,i=e.type,o=e.value,s=e.name,c=e.placeholder,l=e.isValid,u=void 0!==l&&l;return v.a.createElement(g.a,{key:t,row:!0},v.a.createElement(b.a,{for:n,sm:5},a),v.a.createElement(E.a,{sm:7},v.a.createElement(y.a,{type:i,value:o,name:s,placeholder:c,id:n,onChange:r,valid:u,invalid:!u,required:!0}),v.a.createElement(T,{valid:!0},"Sweet! that name is available"),v.a.createElement(T,null,"Sad! That name is already assigned or empty")))}var pe=function(e){function t(e,n){var a;return Object(l.a)(this,t),(a=Object(d.a)(this,Object(f.a)(t).call(this,e,n))).toggle=function(e){var t=e.target.name;a.setState(Object(c.a)({},t,!a.state[t]))},a.handleInputChange=function(e){var t=e.target.name,n=e.target.value,r=a.state.optionTypes[t];a.setState({formValues:Object(s.a)({},a.state.formValues,Object(c.a)({},t,n))});var i=!0,o="";"SizeSuffix"===r?(i=Object(ne.l)(n))||(o="The valid input is size( off | {unit}{metric} eg: 10G, 100M, 10G100M etc.)"):"Duration"===r?(i=Object(ne.j)(n))||(o="The valid input is time ({unit}{metric} eg: 10ms, 100m, 10h15ms etc.)"):"int"===r&&((i=Object(ne.k)(n))||(o="The valid input is int (100,200,300 etc)")),!a.state.required[t]||n&&""!==n||(i=!1)||(o+=" This field is required"),a.setState(function(e){return{isValid:Object(s.a)({},e.isValid,Object(c.a)({},t,i)),formErrors:Object(s.a)({},e.formErrors,Object(c.a)({},t,o))}})},a.changeDriveType=function(e,t){var n=t.newValue,r=a.props.providers,i=n,o={},s={},c={},l={},u={};if(void 0!==i&&""!==i){var d=Object(ne.f)(r,i);void 0!==d&&d.Options.forEach(function(e){var t=e.DefaultStr,n=e.Type,a=e.Name,r=e.Required;0===e.Hide&&(o[a]=t,s[a]=n,u[a]=r,c[a]=!(r&&(!t||""===t)),l[a]="")}),a.setState({drivePrefix:i,formValues:o,optionTypes:s,isValid:c,formErrors:l,required:u})}else a.setState({drivePrefix:i})},a.openSetupDrive=function(e){e&&e.preventDefault(),a.setState({colSetup:!0}),a.setupDriveDiv.scrollIntoView({behavior:"smooth"})},a.editAdvancedOptions=function(e){a.setState({advancedOptions:!a.state.advancedOptions})},a.clearForm=function(e){a.setState({driveName:"",drivePrefix:""})},a.changeName=function(e){var t=e.target.value;a.setState({driveName:t},function(){void 0===t||""===t?a.setState({driveNameIsValid:!1}):te.a.post("/config/get",{name:t}).then(function(e){var t=a.state.formErrors,n=Object(ne.e)(e.data);t.driveName=n?"":"Duplicate",a.setState({formErrors:t,driveNameIsValid:n})})})},a.openAdvancedSettings=function(e){a.state.advancedOptions?a.setState({colAdvanced:!0}):a.configEndDiv.scrollIntoView({behavior:"smooth"})},a.state={colRconfig:!0,colSetup:!1,colAdvanced:!1,driveName:"",advancedOptions:!1,formValues:{},formValuesValid:{},required:{},authModalIsVisible:!1,drivePrefix:"",driveNameIsValid:!1,formErrors:{driveName:""},optionTypes:{},isValid:{}},a.configCheckInterval=null,a.handleSubmit=a.handleSubmit.bind(Object(h.a)(a)),a.toggleAuthModal=a.toggleAuthModal.bind(Object(h.a)(a)),a.startAuthentication=a.startAuthentication.bind(Object(h.a)(a)),a.checkConfigStatus=a.checkConfigStatus.bind(Object(h.a)(a)),a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"checkConfigStatus",value:function(){var e=Object(o.a)(i.a.mark(function e(){var t,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.driveName,e.prev=1,e.next=4,te.a.post("/config/get",{name:t});case 4:n=e.sent,console.log(n),Object(ne.e)(n.data)||(clearInterval(this.configCheckInterval),this.configCheckInterval=null,this.toggleAuthModal(),this.props.history.push("/dashboard")),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log("Error occurred while checking for config: ".concat(e.t0)),le.b.error("Error creating config. ".concat(e.t0),{autoClose:!1});case 13:case"end":return e.stop()}},e,this,[[1,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"validateForm",value:function(){var e=this.state,t=e.driveNameIsValid,n=e.drivePrefix,r=e.isValid,i=!0;t||(i=!1),""===n&&(i=!1);for(var o=0,s=Object.entries(r);o<s.length;o++){var c=s[o],l=Object(a.a)(c,2),u=l[0],d=l[1];if(!u||!d){i=!1;break}}return i}},{key:"toggleAuthModal",value:function(){this.setState(function(e,t){return{authModalIsVisible:!e.authModalIsVisible}})}},{key:"startAuthentication",value:function(){this.toggleAuthModal(),null===this.configCheckInterval?this.configCheckInterval=setInterval(this.checkConfigStatus,1e3):console.error("Interval already running. Should not start a new one")}},{key:"stopAuthentication",value:function(){this.setState(function(e,t){return{authModalIsVisible:!1}}),clearInterval(this.configCheckInterval)}},{key:"handleSubmit",value:function(){var e=Object(o.a)(i.a.mark(function e(t){var n,r,o,s,c,l,u,d,f,h,p,m;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),console.log("Submitted form"),n=this.state,r=n.formValues,o=n.drivePrefix,s=this.props.providers,!this.validateForm()){e.next=27;break}if(void 0===o||""===o){e.next=25;break}if(void 0===(c=Object(ne.f)(s,o))){e.next=25;break}for(l=c.Options,u={},d=function(){var e=h[f],t=(p=Object(a.a)(e,2))[0],n=p[1],r=l.find(function(e,n,a){return t===e.Name}).DefaultStr;n!==r&&(console.log("".concat(n," !== ").concat(r)),u[t]=n)},f=0,h=Object.entries(r);f<h.length;f++)d();return m={parameters:u,name:this.state.driveName,type:this.state.drivePrefix},console.log("Validated form"),this.startAuthentication(),e.prev=15,e.next=18,te.a.post("/config/create",m);case 18:le.b.info("Config created"),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(15),le.b.error("Error creating config. ".concat(e.t0),{autoClose:!1}),this.stopAuthentication();case 25:e.next=30;break;case 27:this.state.colSetup||this.openSetupDrive(),this.state.advancedOptions&&!this.state.colAdvanced&&this.openAdvancedSettings(),le.b.warn("Check for errors before submitting.",{autoClose:!1});case 30:case"end":return e.stop()}},e,this,[[15,21]])}));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){(!this.props.providers||this.props.providers.length<1)&&this.props.getProviders()}},{key:"componentWillUnmount",value:function(){clearInterval(this.configCheckInterval),this.configCheckInterval=null}},{key:"render",value:function(){var e=this,t=this.state,n=t.colRconfig,a=t.colSetup,r=t.colAdvanced,i=t.drivePrefix,o=t.advancedOptions,s=t.driveName,c=t.driveNameIsValid,l=this.props.providers;return v.a.createElement("div",{"data-test":"newDriveComponent"},v.a.createElement("p",null,"This 3 step process will guide you through creating a new config. For auto config, leave the parameters as is."),v.a.createElement(A.a,{onSubmit:this.handleSubmit},v.a.createElement(D.a,null,v.a.createElement(P.a,null,v.a.createElement("h5",null,v.a.createElement(R.a,{color:"link",name:"colRconfig",onClick:this.toggle,style:{marginBottom:"1rem"}},v.a.createElement("strong",null,"Step 1:")," Remote Config"))),v.a.createElement(K,{isOpen:n},v.a.createElement(U.a,null,v.a.createElement(he,{label:"Name of this drive (For your reference)",changeHandler:this.changeName,value:s,placeholder:"Enter a name",name:"name",id:"driveName",isValid:c}),v.a.createElement(g.a,{row:!0},v.a.createElement(b.a,{for:"driveType",sm:5},"Select"),v.a.createElement(E.a,{sm:7},v.a.createElement(ce,{suggestions:l,value:i,onChange:this.changeDriveType}))),v.a.createElement(g.a,{row:!0},v.a.createElement(E.a,{sm:3},v.a.createElement(b.a,{for:"inputDriveName"},"Docs are available at ")," ",v.a.createElement("a",{href:"https://rclone.org/commands/rclone_config/"},"Rclone Config")))),v.a.createElement(W.a,null,v.a.createElement("div",{className:"clearfix"},v.a.createElement(R.a,{color:"success",className:"float-right",onClick:this.openSetupDrive},v.a.createElement("i",{className:"fa fa-check fa-lg "})))))),v.a.createElement(D.a,null,v.a.createElement("div",{ref:function(t){return e.setupDriveDiv=t}}),v.a.createElement(P.a,null,v.a.createElement("h5",null,v.a.createElement(R.a,{color:"link",name:"colSetup",onClick:this.toggle,style:{marginBottom:"1rem"}},v.a.createElement("strong",null,"Step 2:")," Setup Drive"))),v.a.createElement(K,{isOpen:a},v.a.createElement(U.a,null,v.a.createElement(fe,{drivePrefix:i,loadAdvanced:!1,changeHandler:this.handleInputChange,errorsMap:this.state.formErrors,isValidMap:this.state.isValid,currentValues:this.state.formValues,config:l})),v.a.createElement(W.a,null,v.a.createElement("div",{className:"clearfix"},v.a.createElement("div",{className:"float-right"},v.a.createElement(y.a,{type:"checkbox",value:o,onChange:this.editAdvancedOptions}),v.a.createElement("span",{className:"mr-3"},"Edit Advanced Options"),v.a.createElement(R.a,{color:"success",onClick:this.openAdvancedSettings},v.a.createElement("i",{className:"fa fa-check fa-lg "}))))))),v.a.createElement(D.a,null,v.a.createElement(P.a,null,v.a.createElement("h5",null,v.a.createElement(R.a,{color:"link",name:"colAdvanced",onClick:this.toggle,style:{marginBottom:"1rem"}},v.a.createElement("strong",null,"Step 3:")," Advanced (optional)"))),v.a.createElement(K,{isOpen:r},v.a.createElement(U.a,null,v.a.createElement(fe,{drivePrefix:i,loadAdvanced:!0,changeHandler:this.handleInputChange,errorsMap:this.state.formErrors,isValidMap:this.state.isValid,currentValues:this.state.formValues,config:l})))),v.a.createElement("div",{className:"clearfix",ref:function(t){e.configEndDiv=t}},v.a.createElement("div",{className:"float-right mb-3"},v.a.createElement(R.a,{color:"info",type:"reset",onClick:function(){return e.clearForm()}},"Clear"),v.a.createElement(R.a,{color:"success",type:"submit"},"Create Config")))),v.a.createElement(ee,{isVisible:this.state.authModalIsVisible,closeModal:this.toggleAuthModal}))}}]),t}(v.a.Component);t.default=Object(de.b)(function(e){return{providers:e.config.providers}},{getProviders:ue.b})(pe)}}]);
//# sourceMappingURL=16.9ec71de5.chunk.js.map